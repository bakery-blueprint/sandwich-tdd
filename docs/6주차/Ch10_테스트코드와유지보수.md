# Chapter 10 "테스트 코드와 유지보수"


# 테스트 코드와 유지보수
- 테스트 코드는 그 자체로 코드이기 때문에 제품 코드와 동일하게 유지보수 대상이 된다.
- 깨진 테스트 코드를 방치하면 악순환이 반복되므로 테스트 코드 자체의 유지보수성이 좋아야 한다.


## 1. 변수나 필드를 사용해서 기댓값 표현하지 않기
- 기댓값을 변수나 필드를 사용해서 표현하지 않아야 한다. 실제 값을 이용한다.


## 2. 두 개 이상을 검증하지 않기
- 검증대상이 명확하게 분리되는 경우, 테스트 메서드를 분리하여 유지보수에 용이하게 한다.


## 3. 정확하게 일치하는 값으로 모의 객체 설정하지 않기
- 테스트하고자 하는 기능과 상관 없는 부분에 특정값을 넣어 실패하지 말고, Mockito.anyString() 과 같이 범용적인 값으로 테스트한다.


## 4. 과도하게 구현 검증하지 않기
- 내부 구현을 검증하는 것은 나쁘지 않지만, 내부 구현은 언제든지 바뀔 수 있기 때문에 테스트가 깨질 수 있음을 인지해야 한다.
- 내부 구현보다는 실행 결과 검증에 집중.


## 5. 셋업을 이용해서 중복된 상황을 설정하지 않기
- 오랜만에 보거나 남이 작성한 수많은 테스트 메서드를 보다보면, @BeforeEach 에서 무엇을 셋업했는지 모르므로 위아래로 스크롤해가며 파악해야하는 경우 발생
- 셋업 메서드를 변경하면 종속된 메서드들의 테스트가 줄줄이 실패할 수 있음
- -> 따라서 상황 구성 코드가 테스트 메소드 안에 위치해야 한다.

### 5-1) 통합 테스트에서 데이터 공유 주의하기

### 5-2) 통합 테스트의 상황 설정을 위한 보조 클래스 사용하기


## 6. 실행 환경이 다르다고 실패하지 않기
- 절대경로 사용 등.. 환경에 따라 달라지면 안됨.


## 7.실헹 시점이 다르다고 실패하지 않기
- 테스트 코드에서 시간을 명시적으로 제어할수 있는 방법을 선택해야 한다. 
- 대표적으로 값을 파라미터로 넘기는 방식이 있다.

### 7-1) 랜덤하게 실패하지 않기
- 랜덤하게 값이 생성되면 정답을 알 수 없으므로
- 직접 생성자에서 랜덤값을 생성하는것이 아니라, 외부에서 생성자의 인자를 통해 값을 넘겨받도록 한다.


## 8.필요하지 않은 값은 설정하지 않기
- 불필요한 값은 테스트코드를 길게 만들고, 불필요한 고민을 하게 만든다.

### 8-1) 단위 테스트를 위한 객체 생성 보조 클래스
- 빌더, 펙토리 사용


## 9. 조건부로 검증하지 않기
- 단언을 조건부로 실행시키면 안됨.
- 조건도 단언을 사용하도록 수정.


## 10. 통합 테스트는 필요하지 않은 범위까지 연동하지 않기
- @SpringBootTest 애노테이션을 사용하면 서비스, 컨트롤러 등 모든 스프링 빈을 초기화
- DB 관련된 설정 외에 나머지 설정도 처리하므로 스프링을 초기화하는 시간이 길어질 수 있다.
- @JdbcTest 애노테이션을 사용하면 DataSoruce, JdbcTemplate등 DB연동과 관련된 설정만 초기화 한다. 다른 빈을 생성하지 않으므로 스프링을 초기화하는 시간이 짧아진다.


## 11. 더이상 쓸모 없는 테스트 코드
- 특정 클래스 사용법을 익히기 위해 작성한 테스트 코드 등 쓸모없는 테스트 코드는 유지보수에 아무런 도움이 되지 않으므로 삭제한다.


참고
https://blogshine.tistory.com/186
https://blogshine.tistory.com/189